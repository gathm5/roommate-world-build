"use strict";angular.module("roommateWorldApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.router","gsDirectives","ngAutocomplete","ngTell","LocalForageModule","angularMoment","firebase","ui.keypress"]).constant("$config",{backend:{url:"https://torid-torch-8850.firebaseio.com"},fileServer:{url:"http://yippip.com/uploader.html"}}).config(["$stateProvider","$urlRouterProvider","$localForageProvider",function(a,b,c){c.config({name:"RoommateWorld",version:1,storeName:"roommateworldstorage",description:"Store the roommate world"}),c.setNotify(!0,!0),a.state("load",{url:"/load",views:{"@":{templateUrl:"/views/common/selection-screen.html",controller:"SelectionScreenCtrl"}}}).state("start",{views:{"@":{templateUrl:"/views/common/load-screen.html"}}}).state("start.main",{views:{"MainContent@start":{templateUrl:"/views/common/main-content.html",controller:"MainContentCtrl"},"MenuPanel@start":{templateUrl:"/views/menu/menu-panel.html",controller:"MenuPanelCtrl"},"Header@start.main":{templateUrl:"/views/common/header.html",controller:"HeaderCtrl"}}}).state("start.main.dashboard",{url:"/dashboard",resolve:{BackendData:"BackendData"},views:{"Content@start.main":{templateUrl:"/views/dashboard/dashboard.html",controller:"DashboardCtrl"},"SlideMenu@start":{templateUrl:"/views/common/filter.html",controller:"FilterCtrl"}}}).state("start.main.post",{url:"/post",views:{"Content@start.main":{templateUrl:"/views/post/post.html",controller:"PostCtrl"}}}).state("start.main.settings",{url:"/settings",views:{"Content@start.main":{templateUrl:"/views/menu/settings.html",controller:"SettingsCtrl"}}}),b.otherwise("/load")}]).run(["$state","$stateParams","drawerParams","slideOutMenuParams","gsDeviceListeners","Dictionary","$rootScope",function(a,b,c,d,e,f,g){g.$state=a,g.drawerParams=c,g.slideOutMenuParams=d,g.dictionary=f(),e.init(),g.$on("$stateChangeStart",function(){c.close(),d.close()}),g.$on("$device.backbutton",function(a){(c.isDrawerOpen||d.isSlideOpen)&&(a.preventDefault(),a.defaultPrevented=!0,c.close(),d.close(),g.$apply())}),g.$on("$device.menubutton",function(a){a.preventDefault(),a.defaultPrevented=!0,d.isSlideOpen||c.toggle(),g.$apply()})}]),angular.module("roommateWorldApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("roommateWorldApp").controller("FilterCtrl",["$scope","dashboardService",function(a,b){a.filter=null,a.doFilter=function(c){return a.filter?(c&&c.target.blur(),b.setFilter(a.filter),a.filter=null,!0):void 0}}]),angular.module("roommateWorldApp").controller("MainContentCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("roommateWorldApp").controller("HeaderCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("roommateWorldApp").controller("MenuPanelCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("roommateWorldApp").controller("SettingsCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("roommateWorldApp").controller("DashboardCtrl",["$scope","BackendData","userSelectionData","dashboardService","$filter",function(a,b,c,d){var e,f;f=c.label(),a.filterData=d.getFilter(),f=f.substring(0,f.length-1),f=f.toLowerCase(),a.selected=f,b.get().then(function(b){console.log(b),a.displayData=b}),a.remove=function(a){e.remove(a)},a.clearFilter=function(){d.setFilter()},a.selection=c.label(),a.$on("Filter",function(){a.filterData=d.getFilter()}),a.$on("$device.backbutton",function(a){a.defaultPrevented||navigator.app&&navigator.app.exitApp()})}]),angular.module("roommateWorldApp").controller("SelectionScreenCtrl",["$scope","$state","userSelectionData",function(a,b,c){var d={roommates:c.ROOMMATES,rooms:c.ROOMS,apartments:c.APARTMENTS};a.defaultSelected=!0,a.go=function(a){angular.isUndefined(d[a])||(c.select(d[a]),b.go("start.main.dashboard"))},a.$on("$device.backbutton",function(a){a.defaultPrevented||navigator.app&&navigator.app.exitApp()})}]),angular.module("roommateWorldApp").service("userSelectionData",[function(){var a=0,b=this;this.ROOMMATES=0,this.ROOMS=1,this.APARTMENTS=2,this.select=function(b){a=b},this.get=function(){return a},this.label=function(){switch(a){case b.ROOMMATES:return"Roommates";case b.ROOMS:return"Rooms";case b.APARTMENTS:return"Apartments"}}}]),angular.module("roommateWorldApp").factory("Roommate",["BackendData",function(a){return function(){this.get=function(){return a()},this.add=function(a){var b={roommate:{type:"roommate",zipcode:a.zipcode,rent:a.rent,description:a.description}};return BackendData.$add(b)},this.remove=function(a){return BackendData.$remove(BackendData.$getRecord(a))}}}]),angular.module("roommateWorldApp").factory("Room",["BackendData",function(a){return function(){this.get=function(){return a()},this.add=function(a){var b={room:{type:"room",zipcode:a.zipcode,rent:a.rent,description:a.description}};return BackendData.$add(b)},this.remove=function(a){return BackendData.$remove(BackendData.$getRecord(a))}}}]),angular.module("roommateWorldApp").factory("Apartment",["BackendData",function(a){return function(){this.get=function(){return a()},this.add=function(a){var b={apartment:{type:"apartment",zipcode:a.zipcode,rent:a.rent,description:a.description}};return BackendData.$add(b)},this.remove=function(a){return BackendData.$remove(BackendData.$getRecord(a))}}}]),angular.module("roommateWorldApp").controller("PostCtrl",["$scope","$state","Room","Roommate","Apartment",function(a,b,c,d,e){var f;a.options=["rooms","roommates","apartments"],a.selected=a.options[1],a.postData={zipcode:null,type:null,rent:null,description:null},a.select=function(b){a.selected=b,a.postData.type=b},a.post=function(g){switch(g&&g.target.blur(),a.selected){case"rooms":f=new c;break;case"roommates":f=new d;break;case"apartments":f=new e}a.postData.type=a.selected,a.postData.zipcode&&a.postData.type&&a.postData.rent&&a.postData.description?f.add(a.postData)?(a.apiCallBack={success:!0,message:a.dictionary.post.success,showButton:!1},b.go("load")):a.apiCallBack={success:!1,message:a.dictionary.post.failure,showButton:!0}:a.apiCallBack={success:!1,message:a.dictionary.post.empty,showButton:!0}},a.apiCallBack={showButton:!0},a.$on("$device.backbutton",function(a){a.defaultPrevented||b.go("load")})}]),angular.module("roommateWorldApp").factory("BackendData",["$config","$firebase","$q",function(a,b,c){function d(){return e}var e={j8sdf4:{room:{type:"room",zipcode:"93454",rent:"500",description:"Looking for a room near downtown"}},j8sdf4s:{roommate:{type:"roommate",zipcode:"63454",rent:"450",description:"Student/working professional"}},j8sdef4:{roommate:{type:"roommate",zipcode:"43544",rent:"680",description:"Looking for a working professional"}},j8sdfd4:{apartment:{type:"apartment",zipcode:"74564",rent:"2100",description:"Nice 2 bedroom apartment"}}};return d.prototype.$add=function(a){var b="j"+100*Math.random();e[b]=a},{get:function(){var d=c.defer();return d.resolve(b(new Firebase(a.backend.url)).$asArray()),d.promise}}}]),angular.module("roommateWorldApp").filter("listFilter",function(){return function(a,b){var c=[];for(var d in a)a[d][b]&&c.push(a[d]);return c}}),angular.module("roommateWorldApp").factory("Dictionary",function(){var a={post:{success:"Your data was added",failure:"Data was not added. Kindly re-try",empty:"Please input all data",room:{label:"Looking for a room rent of"},roommate:{label:"Who can pay around"},apartment:{label:"Rent"}}};return function(){return a}}),angular.module("roommateWorldApp").directive("rentalDisplay",function(){return{templateUrl:"/views/directives/rental-display.html",restrict:"E",scope:{rentalItem:"=display"},replace:!0,link:function(){}}}),angular.module("roommateWorldApp").factory("dashboardService",["$Tell",function(a){var b=null;return{getFilter:function(){return b},setFilter:function(c){b=c,a.children("dashboard","Filter",{filter:c})}}}]),angular.module("roommateWorldApp").factory("fileUploadService",["$config","$q",function(a,b){return{selected:function(a){for(var b=a.files.length,c=[],d=0;b>d;d++){var e=a.files[d],f=0;f=e.size>1048576?(Math.round(100*e.size/1048576)/100).toString()+"MB":(Math.round(100*e.size/1024)/100).toString()+"KB",c.push({name:e.name,size:f,type:e.type})}return c},upload:function(c){for(var d=new FormData,e=c.files.length,f=b.defer(),g=new XMLHttpRequest,h="POST",i=0;e>i;i++){var j=c.files[i];d.append("myFile",j)}return g.addEventListener("load",function(a){f.resolve(a)},!1),g.addEventListener("error",function(a){f.reject(a)},!1),g.addEventListener("abort",function(a){f.reject(a)},!1),g.open(h,a.fileServer.url),g.send(d),f.promise}}}]),angular.module("roommateWorldApp").directive("fileUpload",["fileUploadService",function(a){return{template:'<input type="file" accept="image/*" capture="camera" />',restrict:"E",replace:!0,scope:{uploadReady:"=",uploaded:"="},link:function(b,c){b.selected=function(){b.selectedParams=a.selected(c[0])},b.uploaded={flag:!1,reason:null},b.$watch("uploadReady",function(d){d&&a.upload(c[0]).then(function(a){b.uploaded={flag:!0,reason:a}},function(a){b.uploaded={flag:!1,reason:a}})})}}}]);